{"ast":null,"code":"import _slicedToArray from\"/Users/sindritomasson/Desktop/youtube/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import Card from\"../Card/Card\";import{GridContainer,Outer}from\"./ContentStyles\";import{useSelector}from\"react-redux\";import axios from\"axios\";import\"./content.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Content=function Content(_ref){var searchTerm=_ref.searchTerm;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),videoResult=_useState4[0],setVideoResult=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),profileThumbnails=_useState6[0],setProfileThumbnails=_useState6[1];var API_KEY=\"AIzaSyA2jqu8DsVe541pB-A3pNX0Hg3gIDMpnQs\";var url=useSelector(function(state){return state.url;});//todo Denne linken gir de mest populære videoene:\n// https://www.googleapis.com/youtube/v3/videos?key=AIzaSyAA2UebdaJgjkACyxTuuCHEnOsywZ1sAWc&part=snippet,id&chart=mostPopular\n//todo Sett denne som default\nuseEffect(function(){setIsLoading(true);fetchVideoData();//TODO JA URL ER KNUTTET MED USER DETTE ER NOE REDUC GREIER SE PÅ SENERE\n},[url]);var fetchVideoData=function fetchVideoData(){// Gives basic information about the video\nvar searchResults=\"https://www.googleapis.com/youtube/v3/search?key=\".concat(API_KEY,\"\\n                           &part=snippet,id&maxResults=20&q=\").concat(searchTerm,\"&order=viewCount&type=video\");axios(searchResults).then(function(res){var _res$data$items;var videoTuple=new Map();var requests=(_res$data$items=res.data.items)===null||_res$data$items===void 0?void 0:_res$data$items.map(function(video){// Gives a more detailed information about the video\nvar url=\"https://www.googleapis.com/youtube/v3/videos?id=\".concat(video.id.videoId,\"&key=\").concat(API_KEY,\"\\n                     &part=snippet,contentDetails,statistics,status\");// Gives information about the channel\nvar profileUrl=\"https://www.googleapis.com/youtube/v3/channels?part=snippet&id=\".concat(video.snippet.channelId,\"&key=\").concat(API_KEY);// Sets the key in the Map to the videoId\nvideoTuple.set(video.id.videoId,[]);// Two return statements separated by comma\n// The first return statement fills up the first position in the array in the Map with res.data\n// The second return statement fills up the second position in the array in the Map with the profile picture\n/**  The return statements does not run synchronously, but when the loop is done, the first and second\n           positions in the array will be filled up in the correct order since the return statements are independent **/return axios.get(url).then(function(res){videoTuple.get(video.id.videoId)[0]=res.data;//console.log(video.id.videoId);\n}),axios.get(profileUrl).then(function(res){videoTuple.get(video.id.videoId)[1]=res.data.items[0].snippet.thumbnails.default.url;//console.log(video.id.videoId);\n});});// When all request are finished inside requests\nreturn Promise.all(requests).then(function(){var posts=[];var profilePictures=[];videoTuple.forEach(function(video){posts.push(video[0]);profilePictures.push(video[1]);});setVideoResult(posts);setProfileThumbnails(profilePictures);setIsLoading(false);});});};// Displaying loading while waiting for fetching data\nif(isLoading){return/*#__PURE__*/_jsx(\"section\",{className:\"outer\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading...\"})});}// Filtrer ut alle undefined objects\nvar filteredArray=[];var filtered=videoResult===null||videoResult===void 0?void 0:videoResult.filter(function(element){if(element===undefined){return false;}filteredArray.push(element);});return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Outer,{children:/*#__PURE__*/_jsx(GridContainer,{children:filteredArray===null||filteredArray===void 0?void 0:filteredArray.map(function(_ref2,index){var items=_ref2.items;// Checks if a maxres image exists\n// If it does: set maxres, else set highres\nvar imageRes=items[0].snippet.thumbnails.maxres?\"maxresdefault\":\"hqdefault\";var pp=profileThumbnails[index];return/*#__PURE__*/_jsx(Card,{title:items[0].snippet.title.slice(0,50),imageId:items[0].id,imageRes:imageRes,channel:items[0].snippet.channelTitle,profilePicture:pp},index);})})})});};export default Content;","map":{"version":3,"sources":["/Users/sindritomasson/Desktop/youtube/frontend/src/components/Content/ContentSearch.tsx"],"names":["React","useState","useEffect","Card","GridContainer","Outer","useSelector","axios","Content","searchTerm","isLoading","setIsLoading","videoResult","setVideoResult","profileThumbnails","setProfileThumbnails","API_KEY","url","state","fetchVideoData","searchResults","then","res","videoTuple","Map","requests","data","items","map","video","id","videoId","profileUrl","snippet","channelId","set","get","thumbnails","default","Promise","all","posts","profilePictures","forEach","push","filteredArray","filtered","filter","element","undefined","index","imageRes","maxres","pp","title","slice","channelTitle"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\n\nimport Card from \"../Card/Card\";\nimport { GridContainer, Outer } from \"./ContentStyles\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { State } from \"../../state/reducers\";\n\nimport axios from \"axios\";\n\nimport \"./content.css\";\n\ninterface ContentProps {\n  searchTerm?: string;\n}\n\nconst Content: React.FC<ContentProps> = ({ searchTerm }) => {\n  const [isLoading, setIsLoading] = useState<Boolean>(true);\n  const [videoResult, setVideoResult] = useState<any[]>([]);\n  const [profileThumbnails, setProfileThumbnails] = useState<any[]>([]);\n\n  const API_KEY = \"AIzaSyA2jqu8DsVe541pB-A3pNX0Hg3gIDMpnQs\";\n  const url = useSelector((state: State) => state.url);\n\n  //todo Denne linken gir de mest populære videoene:\n  // https://www.googleapis.com/youtube/v3/videos?key=AIzaSyAA2UebdaJgjkACyxTuuCHEnOsywZ1sAWc&part=snippet,id&chart=mostPopular\n  //todo Sett denne som default\n\n  useEffect(() => {\n    setIsLoading(true);\n    fetchVideoData();\n    //TODO JA URL ER KNUTTET MED USER DETTE ER NOE REDUC GREIER SE PÅ SENERE\n  }, [url]);\n\n  const fetchVideoData = () => {\n    // Gives basic information about the video\n    const searchResults = `https://www.googleapis.com/youtube/v3/search?key=${API_KEY}\n                           &part=snippet,id&maxResults=20&q=${searchTerm}&order=viewCount&type=video`;\n\n    axios(searchResults).then((res) => {\n      const videoTuple: any = new Map();\n\n      const requests = res.data.items?.map((video: any) => {\n        // Gives a more detailed information about the video\n        const url = `https://www.googleapis.com/youtube/v3/videos?id=${video.id.videoId}&key=${API_KEY}\n                     &part=snippet,contentDetails,statistics,status`;\n\n        // Gives information about the channel\n        const profileUrl = `https://www.googleapis.com/youtube/v3/channels?part=snippet&id=${video.snippet.channelId}&key=${API_KEY}`;\n\n        // Sets the key in the Map to the videoId\n        videoTuple.set(video.id.videoId, []);\n\n        // Two return statements separated by comma\n        // The first return statement fills up the first position in the array in the Map with res.data\n        // The second return statement fills up the second position in the array in the Map with the profile picture\n\n        /**  The return statements does not run synchronously, but when the loop is done, the first and second\n           positions in the array will be filled up in the correct order since the return statements are independent **/\n\n        return (\n          axios.get(url).then((res) => {\n            videoTuple.get(video.id.videoId)[0] = res.data;\n            //console.log(video.id.videoId);\n          }),\n          axios.get(profileUrl).then((res) => {\n            videoTuple.get(video.id.videoId)[1] = res.data.items[0].snippet.thumbnails.default.url;\n            //console.log(video.id.videoId);\n          })\n        );\n      });\n\n      // When all request are finished inside requests\n      return Promise.all(requests).then(() => {\n        const posts: any = [];\n        const profilePictures: any = [];\n\n        videoTuple.forEach((video: any) => {\n          posts.push(video[0]);\n          profilePictures.push(video[1]);\n        });\n        setVideoResult(posts);\n        setProfileThumbnails(profilePictures);\n        setIsLoading(false);\n      });\n    });\n  };\n  // Displaying loading while waiting for fetching data\n  if (isLoading) {\n    return (\n      <section className=\"outer\">\n        <div className=\"loading\">Loading...</div>\n      </section>\n    );\n  }\n\n  // Filtrer ut alle undefined objects\n  let filteredArray: Array<any> = [];\n  const filtered = videoResult?.filter((element) => {\n    if (element === undefined) {\n      return false;\n    }\n    filteredArray.push(element);\n  });\n\n  return (\n    <>\n      <Outer>\n        <GridContainer>\n          {filteredArray?.map(({ items }, index) => {\n            // Checks if a maxres image exists\n            // If it does: set maxres, else set highres\n            let imageRes: string = items[0].snippet.thumbnails.maxres ? \"maxresdefault\" : \"hqdefault\";\n            let pp: string = profileThumbnails[index];\n\n            return (\n              <Card\n                key={index}\n                title={items[0].snippet.title.slice(0, 50)}\n                imageId={items[0].id}\n                imageRes={imageRes}\n                channel={items[0].snippet.channelTitle}\n                profilePicture={pp}\n              />\n            );\n          })}\n        </GridContainer>\n      </Outer>\n    </>\n  );\n};\n\nexport default Content;\n"]},"metadata":{},"sourceType":"module"}